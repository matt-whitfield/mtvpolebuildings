---
import Layout from '../layouts/Layout.astro';
import Card from '../components/card.astro';
import ContentSection from '../components/contentSection.astro';
import LocationContactCard from '../components/LocationContactCard.astro';
import WorkGallery from '../components/WorkGallery.astro';
import QuoteForm from '../components/QuoteForm.astro';

// Update the serviceCards array to use the icons from the public/icons folder
const serviceCards = [
  {
    icon: '/icons/warehouse.svg', // Updated to use the warehouse icon
    heading: 'Pole Buildings',
    subheading: 'Custom designed and built to your specifications.'
  },
  {
    icon: "/icons/hammer.svg",
    heading: "Residential & Commercial Solutions",
    subheading: "Flexible designs that adapt to your home or business requirements"
},
{
    icon: "/icons/drill.svg",
    heading: "Full-Service Upgrades",
    subheading: "Comprehensive add-ons to maximize your space and property value"
},
  {
    icon: '/icons/lock.svg', 
    heading: 'Licensed and Insured',
    subheading: 'So you have peace of mind the job gets done right, with the quality standards you deserve'
  },
  {
    icon: '/icons/pencil.svg', 
    heading: 'Free Estimates',
    subheading: 'Saves you money and increases the value of your investment'
  },
  {
    icon: '/icons/hourglass.svg', 
    heading: 'Unsurpassed Expertise',
    subheading: 'Pole building experts with a legacy of quality construction dating back over 40 years'
  },
];
---
<Layout 
  title="Mountain View Pole Buildings - Licensed Contractors Working in North Idaho & Montana"
  description="Mountain View Pole Buildings specializes in custom pole buildings with over 40 years of experience. Serving North Idaho and Western Montana."
  image="/images/mtvpb_4-3.webp"
  canonicalURL="https://www.mtvpolebuildings.com"
  keywords="pole buildings, pole barns, custom construction, North Idaho, Western Montana, licensed contractors"
>
  <!--Hero Section -->
  <div class="hero-section relative py-20 flex items-center">
    <!-- Hero background with optimized loading strategy -->
    <div class="absolute inset-0" id="hero-background">
      <!-- Show poster image immediately for LCP, load video lazily -->
      <img 
        src="/images/mtvpb_4-3.webp" 
        alt="Mountain View Pole Buildings construction" 
        class="w-full h-full object-cover"
        loading="eager"
        fetchpriority="high"
        id="hero-poster"
      />
      <!-- Video loads after initial render -->
      <video 
        autoplay 
        loop 
        muted 
        playsinline 
        preload="none"
        class="w-full h-full object-cover absolute inset-0 opacity-0 transition-opacity duration-1000"
        id="hero-video"
        style="display: none;"
      >
        <source src="/video/trussRaise-square-06-23-2023_1.mp4" type="video/mp4" />
      </video>
      <div class="absolute inset-0 bg-gradient-to-t from-[#304A61]/90 from-20% to-[#304A61]/30 md:bg-gradient-to-r md:from-[#304A61]/90 md:from-20% md:via-[#304A61]/50 md:via-50% md:to-transparent"></div>
    </div>
    <div class="relative z-10 flex flex-col items-start justify-end w-full text-left px-4 py-16 max-w-4xl mx-auto lg:ml-16 h-full mt-auto pb-8 md:mt-0 md:pb-0 md:justify-center">
      <div class="max-w-2xl mt-auto md:mt-0">
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-white mb-6 leading-tight text-animate">
          Licensed Contractors Building with Integrity and Over 40 Years of Experience
        </h1>
        <p class="text-lg md:text-xl text-white mb-8 animate-slide-up">
          Mountain View Pole Buildings operates out of Shoshone county in North Idaho. We're a small contracting outfit serving locally and in Western Montana.
        </p>
        <a href="#quote-form" class="btn-primary">
          Request a Quote
        </a>
      </div>
    </div>
  </div>

  <!-- Services/Features Section -->
  <section class="gradient-section-1 section-padding">
    <div class="container mx-auto px-4">
      <!-- <h2 class="text-3xl font-bold text-center mb-12">What We Do</h2>  -->

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center">
        {serviceCards.map(card => (
          <Card 
            icon={card.icon}
            heading={card.heading}
            subheading={card.subheading}
          />
        ))}
      </div>
    </div>
  </section>

  
    <ContentSection/>
  

  
    <LocationContactCard 
  title="Our Service Area" 
  subtitle="Mountain View Pole Buildings proudly serves clients throughout North Idaho and Western Montana"
  mapRadius={50}
  
  quoteButtonUrl="#quote-form"
  quoteButtonText="Request Your Free Quote"
/>
  

  <!-- Work Gallery Section -->
  
    <WorkGallery 
      title="Our Work"
      subtitle="Take a look at some of our recent projects"
      buttonText="See More Work"
      buttonUrl="/work"
    />
  

  <!-- Quote Form Section -->
  <section class="gradient-section-1 section-padding" id="quote-form">
    <QuoteForm />
  </section>
</Layout>

<script>
// Optimized hero video loading - load after critical content
document.addEventListener('DOMContentLoaded', () => {
  const heroVideo = document.getElementById('hero-video');
  const heroPoster = document.getElementById('hero-poster');
  
  if (heroVideo && heroPoster) {
    // Load video after a short delay to prioritize LCP
    setTimeout(() => {
      heroVideo.style.display = 'block';
      heroVideo.load(); // Start loading the video
      
      // Once video can play, fade it in
      heroVideo.addEventListener('canplay', () => {
        heroVideo.style.opacity = '1';
        // Optional: hide poster after video loads
        setTimeout(() => {
          heroPoster.style.opacity = '0.5';
        }, 1000);
      }, { once: true });
    }, 100); // Small delay to let critical content render first
  }
});
</script>

<style>
  .btn-primary {
    background-color: #1a5276; /* Deeper blue that conveys trust and reliability */
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 0.125rem;
    font-weight: 600;
    display: inline-block;
    text-decoration: none;
    transition: background-color 0.3s ease;
  }
  
  .btn-primary:hover {
    background-color: #2471a3; /* Slightly lighter blue on hover for feedback */
  }
</style>
